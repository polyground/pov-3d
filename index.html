<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="examples/example.style.css" />
    <title>Pov-3d Example</title>
    <script type="module" src="./src/pov_3d_viewer.js"></script>
    <script src="src/pov_3d_viewer.js"></script>
  </head>
  <body>
    <main>
      <div class="side_box">
        <header>
          <h1><a href="index.html">Pov-3d</a></h1>
        </header>

        <p>This is a simple example of how to use Pov-3d.</p>
        <nav>
          <!--          <a href="../simple/index.html">Simple example</a>-->
          <!--          <a href="./index.html">Dynamic example</a>-->
        </nav>
      </div>

      <!--      <pov-3d-viewer-->
      <!--        id="pov-3d-viewer"-->
      <!--        auto_rotate="on"-->
      <!--        model="examples/sampleModel/Old_ToadCenser.glb"-->
      <!--        load_progress="on"-->
      <!--        base_color="#ff0000"-->
      <!--        preset="Polyground"-->
      <!--      ></pov-3d-viewer>-->
      <pov-3d-viewer id="pov-3d-viewer"></pov-3d-viewer>
      <div class="option_area">
        <label for="select-base-color-picker">Select BaseColor</label>
        <div class="color_picker_wrap">
          <input
            class="color_picker"
            type="color"
            id="select-base-color-picker"
            onchange="changeBaseColorPicker(this.value)"
          />
          <input
            class="color_picker_input"
            type="text"
            id="select-base-color-input"
            aria-label="select-base-color-input"
            onfocusout="changeBaseColorInput(this.value)"
          />
        </div>

        <label for="select-background-color-picker"
          >Select BackgroundColor</label
        >
        <div class="color_picker_wrap">
          <input
            class="color_picker"
            type="color"
            id="select-background-color-picker"
            onchange="changeBackgroundColorPicker(this.value)"
          />
          <input
            class="color_picker_input"
            type="text"
            id="select-background-color-input"
            aria-label="select-background-color-input"
            onfocusout="changeBackgroundColorInput(this.value)"
          />
        </div>

        <label for="select-preset">Select Preset</label>
        <select
          id="select-preset"
          is="pov-3d-viewer"
          onchange="changePreset(this.value)"
        >
          <option value="Initial">Initial</option>
          <option value="Bright">Bright</option>
          <option value="Dark">Dark</option>
          <option value="Polyground">Polyground</option>
        </select>
        <label for="select-model">Select Model</label>
        <select
          id="select-model"
          is="pov-3d-viewer"
          onchange="changeModel(this.value)"
        >
          <option value="examples/sampleModel/Old_ToadCenser.glb">
            Old_ToadCenser
          </option>
          <option value="examples/sampleModel/Large_Silver_Pistol.fbx">
            Fbx Example(Large_Silver_Pistol)
          </option>
          <option value="examples/sampleModel/Old_Treasure_Box.fbx">
            Fbx Example(Old_Treasure_Box)
          </option>
          <option value="examples/sampleModel/Religious_Buddhism_Statue.obj">
            Obj Example(Religious_Buddhism_Statue)
          </option>
        </select>
      </div>

      <script>
        const viewer = document.getElementById("pov-3d-viewer");

        let defaultBaseColor = "#ff0000";
        let defaultBackgroundColor = "#000000";

        const baseColorInput = document.getElementById(
          "select-base-color-input",
        );
        const baseColorPicker = document.getElementById(
          "select-base-color-picker",
        );
        baseColorInput.value = defaultBaseColor;
        baseColorPicker.value = defaultBaseColor;

        const backgroundColorInput = document.getElementById(
          "select-background-color-input",
        );
        const backgroundColorPicker = document.getElementById(
          "select-background-color-picker",
        );
        backgroundColorInput.value = defaultBackgroundColor;
        backgroundColorPicker.value = defaultBackgroundColor;

        const presetSelect = document.getElementById("select-preset");
        presetSelect.value = "Initial";

        viewer.addEventListener("pov-setup", () => {
          viewer.setAttribute("preset", presetSelect.value);
          viewer.setAttribute("base_color", baseColorPicker.value);
          viewer.setAttribute("background_color", "#000000");
          viewer.setAttribute("auto_rotate", "on");
          viewer.setAttribute("load_progress", "on");
        });

        viewer.addEventListener("pov-ready", () => {
          viewer.setAttribute(
            "model",
            "examples/sampleModel/Old_ToadCenser.glb",
          );
        });

        viewer.addEventListener("pov-event", (e) => {
          if (e.detail.type === "load_progress") {
            console.log(e.detail.loaded, e.detail.total);
          }
        });

        viewer.addEventListener("pov-model-loaded", () => {
          console.log("Model Load Successfully");
        });

        function changeModel(model) {
          viewer.setAttribute("model", model);
        }
        function changePreset(preset) {
          viewer.setAttribute("preset", preset);
        }
        function changeBaseColorPicker(baseColor) {
          viewer.setAttribute("base_color", baseColor);
          baseColorInput.value = baseColor;
        }
        function changeBaseColorInput(baseColor) {
          const isValidHexColor = /^#([0-9A-F]{3}){1,2}$/i.test(baseColor);
          if (isValidHexColor) {
            baseColorPicker.value = baseColor;
            viewer.setAttribute("base_color", baseColor);
          } else {
            baseColorInput.value = "";
          }
        }
        function changeBackgroundColorPicker(backgroundColor) {
          viewer.setAttribute("background_color", backgroundColor);
          backgroundColorInput.value = backgroundColor;
        }
        function changeBackgroundColorInput(backgroundColor) {
          const isValidHexColor = /^#([0-9A-F]{3}){1,2}$/i.test(
            backgroundColor,
          );
          if (isValidHexColor) {
            backgroundColorPicker.value = backgroundColor;
            viewer.setAttribute("background_color", backgroundColor);
          } else {
            backgroundColorInput.value = "";
          }
        }
      </script>
    </main>
    <footer>
      <p>Â© 2024 Pov-3d</p>
    </footer>
  </body>
</html>
